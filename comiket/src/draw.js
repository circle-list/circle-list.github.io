mapAssets={s1:{x:[1120,1060,1e3,940,880,820,760,700,640,580,520,460,400,340,280,220,160,100,40],y:[420,240,60],s:[7,7,7,5,5,5,6,6,7,7,7,7,7,6,5,5,6,6,6],mark:["イ","ウ","エ","オ","カ","キ","ク","ケ","コ","サ","シ","ス","セ","ソ","タ","チ","ツ","テ","ト"],"mark-coord":[{x:1200,y:595,c:"ア"},{x:1200,y:0,c:"ア"},{x:30,y:595,c:"ア"},{x:10,y:25,c:"ア"}],wall:[{x:520,y:620},{x:500,y:620},{x:480,y:620},{x:0,y:600},{x:0,y:580},{x:0,y:540},{x:0,y:520},{x:0,y:480},{x:0,y:460},{x:20,y:20},{x:40,y:20},{x:60,y:20},{x:100,y:20},{x:240,y:40},{x:260,y:40},{x:280,y:40},{x:340,y:20},{x:360,y:20},{x:380,y:20},{x:420,y:20},{x:440,y:20},{x:480,y:20},{x:500,y:20},{x:700,y:20},{x:720,y:20},{x:760,y:20},{x:860,y:40},{x:880,y:40},{x:900,y:40},{x:960,y:20},{x:980,y:20},{x:1e3,y:20},{x:1040,y:20},{x:1060,y:20},{x:1100,y:20},{x:1120,y:20},{x:1200,y:80},{x:1200,y:100},{x:1200,y:140},{x:1200,y:160},{x:1200,y:200},{x:1200,y:220},{x:1200,y:240},{x:1200,y:260},{x:1200,y:380},{x:1200,y:400},{x:1200,y:420},{x:1200,y:440},{x:1200,y:460},{x:1200,y:500},{x:1200,y:520},{x:1200,y:560},{x:1200,y:580},{x:1170,y:620},{x:1150,y:620},{x:1120,y:620},{x:1100,y:620}]},s2:{x:[1120,1060,1e3,940,880,820,760,700,640,580,520,460,400,340,280,220,160,100,40],y:[420,240,60],s:[7,7,7,7,5,5,7,7,7,7,7,7,7,5,5,5,7,7,7],mark:["ニ","ヌ","ネ","ノ","ハ","ヒ","フ","ヘ","ホ","マ","ミ","ム","メ","モ","ヤ","ユ","ヨ","ラ","リ"],"mark-coord":[{x:900,y:595,c:"ナ"},{x:1200,y:0,c:"ナ"},{x:300,y:595,c:"ナ"},{x:90,y:0,c:"ナ"}],wall:[{x:940,y:620},{x:960,y:620},{x:990,y:620},{x:1010,y:620},{x:1040,y:620},{x:1060,y:620},{x:1100,y:620},{x:1120,y:620},{x:1150,y:620},{x:1170,y:620},{x:1200,y:620},{x:1200,y:600},{x:1200,y:580},{x:1200,y:560},{x:1200,y:520},{x:1200,y:500},{x:1200,y:460},{x:1200,y:440},{x:1200,y:260},{x:1200,y:240},{x:1200,y:220},{x:1200,y:200},{x:1200,y:160},{x:1200,y:140},{x:1200,y:100},{x:1200,y:80},{x:1200,y:60},{x:900,y:40},{x:880,y:40},{x:860,y:40},{x:740,y:20},{x:700,y:20},{x:680,y:20},{x:500,y:20},{x:480,y:20},{x:440,y:20},{x:420,y:20},{x:280,y:40},{x:260,y:40},{x:240,y:40},{x:60,y:20},{x:40,y:20},{x:20,y:20},{x:340,y:620},{x:360,y:620},{x:380,y:620},{x:400,y:620},{x:420,y:620},{x:440,y:620},{x:480,y:620},{x:500,y:620},{x:530,y:620},{x:550,y:620}]},w1:{"wall-1":[{x:360,y:1220},{x:340,y:1220},{x:320,y:1220},{x:300,y:1220},{x:280,y:1220},{x:260,y:1220},{x:240,y:1220},{x:220,y:1220},{x:200,y:1220},{x:180,y:1220},{x:160,y:1220},{x:140,y:1220},{x:120,y:1220},{x:100,y:1220},{x:80,y:1220},{x:0,y:1120},{x:0,y:1100},{x:0,y:1080},{x:0,y:1040},{x:0,y:1e3},{x:0,y:960},{x:0,y:940},{x:0,y:920},{x:0,y:700},{x:0,y:680},{x:0,y:660},{x:0,y:500},{x:0,y:480},{x:0,y:460},{x:0,y:320},{x:0,y:300},{x:0,y:280},{x:0,y:260},{x:0,y:200},{x:0,y:160},{x:0,y:100},{x:0,y:80},{x:0,y:60},{x:0,y:40},{x:110,y:0},{x:130,y:0},{x:150,y:0},{x:200,y:0},{x:240,y:0},{x:310,y:0},{x:330,y:0},{x:350,y:0},{x:570,y:0},{x:590,y:0},{x:610,y:0},{x:680,y:0},{x:720,y:0},{x:790,y:0},{x:810,y:0},{x:830,y:0},{x:600,y:380},{x:580,y:380},{x:560,y:380},{x:540,y:380},{x:420,y:460},{x:420,y:480},{x:420,y:500},{x:420,y:520},{x:420,y:880},{x:420,y:900},{x:420,y:920},{x:420,y:940},{x:420,y:1080},{x:420,y:1100},{x:420,y:1120},{x:420,y:1140},{x:420,y:1160}],"wall-2":[{x:1420,y:1220},{x:1440,y:1220},{x:1460,y:1220},{x:1480,y:1220},{x:1500,y:1220},{x:1520,y:1220},{x:1540,y:1220},{x:1560,y:1220},{x:1580,y:1220},{x:1600,y:1220},{x:1620,y:1220},{x:1640,y:1220},{x:1660,y:1220},{x:1680,y:1220},{x:1700,y:1220},{x:-20,y:-20},{x:-20,y:-20},{x:-20,y:-20},{x:-20,y:-20},{x:-20,y:-20},{x:1780,y:960},{x:1780,y:940},{x:1780,y:920},{x:1780,y:700},{x:1780,y:680},{x:1780,y:660},{x:1780,y:500},{x:1780,y:480},{x:1780,y:460},{x:1780,y:320},{x:1780,y:300},{x:1780,y:280},{x:1780,y:260},{x:-20,y:-20},{x:-20,y:-20},{x:1780,y:100},{x:1780,y:80},{x:1780,y:60},{x:1780,y:40},{x:1670,y:0},{x:1650,y:0},{x:1630,y:0},{x:1580,y:0},{x:1540,y:0},{x:1470,y:0},{x:1450,y:0},{x:1430,y:0},{x:1210,y:0},{x:1190,y:0},{x:1170,y:0},{x:1100,y:0},{x:1060,y:0},{x:990,y:0},{x:970,y:0},{x:950,y:0},{x:1180,y:380},{x:1200,y:380},{x:1220,y:380},{x:1240,y:380},{x:1360,y:460},{x:1360,y:480},{x:1360,y:500},{x:1360,y:520},{x:1360,y:860},{x:1360,y:880},{x:1360,y:900},{x:1360,y:920},{x:1360,y:1080},{x:1360,y:1100},{x:1360,y:1120},{x:1360,y:1140},{x:1360,y:1160}],"mark-coord":[{x:1755,y:1195,c:"あ"},{x:1755,y:-15,c:"あ"},{x:1315,y:355,c:"あ"},{x:15,y:-15,c:"れ"},{x:455,y:355,c:"れ"},{x:20,y:1195,c:"れ"}],"mark-list":{"い":[{x:1700,y:1060,s:5},{x:1700,y:860,s:7},{x:1700,y:640,s:7}],"う":[{x:1640,y:1060,s:6},{x:1640,y:860,s:7},{x:1640,y:640,s:7}],"え":[{x:1580,y:1060,s:6},{x:1580,y:860,s:7},{x:1580,y:640,s:7}],"お":[{x:1520,y:1060,s:6},{x:1520,y:860,s:7},{x:1520,y:640,s:7}],"か":[{x:1460,y:1060,s:6},{x:1460,y:860,s:7},{x:1460,y:640,s:7}],"き":[{x:1400,y:1060,s:5},{x:1400,y:860,s:7},{x:1400,y:640,s:7}],"く":[{x:1700,y:420,s:7},{x:1700,y:220,s:7},{x:1700,y:60,s:4}],"け":[{x:1640,y:420,s:7},{x:1640,y:220,s:7},{x:1640,y:60,s:4}],"こ":[{x:1580,y:420,s:7},{x:1580,y:220,s:7},{x:1580,y:60,s:4}],"さ":[{x:1520,y:420,s:7},{x:1520,y:220,s:7},{x:1520,y:60,s:4}],"し":[{x:1460,y:420,s:7},{x:1460,y:220,s:7},{x:1460,y:60,s:4}],"す":[{x:1400,y:420,s:7},{x:1400,y:220,s:7},{x:1400,y:60,s:4}],"せ":[{x:1340,y:220,s:4},{x:1340,y:80,s:3}],"そ":[{x:1280,y:220,s:4},{x:1280,y:80,s:3}],"た":[{x:1220,y:220,s:5},{x:1220,y:60,s:4}],"ち":[{x:1160,y:220,s:5},{x:1160,y:60,s:4}],"つ":[{x:1100,y:220,s:5},{x:1100,y:60,s:4}],"て":[{x:1040,y:220,s:5},{x:1040,y:60,s:4}],"と":[{x:980,y:220,s:5},{x:980,y:60,s:4}],"ぬ":[{x:780,y:220,s:5},{x:780,y:60,s:4}],"ね":[{x:720,y:220,s:5},{x:720,y:60,s:4}],"の":[{x:660,y:220,s:5},{x:660,y:60,s:4}],"は":[{x:600,y:220,s:5},{x:600,y:60,s:4}],"ひ":[{x:540,y:220,s:5},{x:540,y:60,s:4}],"ふ":[{x:480,y:220,s:4},{x:480,y:80,s:3}],"へ":[{x:420,y:220,s:4},{x:420,y:80,s:3}],"ほ":[{x:360,y:420,s:7},{x:360,y:220,s:7},{x:360,y:60,s:4}],"ま":[{x:300,y:420,s:7},{x:300,y:220,s:7},{x:300,y:60,s:4}],"み":[{x:240,y:420,s:7},{x:240,y:220,s:7},{x:240,y:60,s:4}],"む":[{x:180,y:420,s:7},{x:180,y:220,s:7},{x:180,y:60,s:4}],"め":[{x:120,y:420,s:7},{x:120,y:220,s:7},{x:120,y:60,s:4}],"も":[{x:60,y:420,s:7},{x:60,y:220,s:7},{x:60,y:60,s:4}],"や":[{x:360,y:1060,s:6},{x:360,y:860,s:7},{x:360,y:640,s:7}],"ゆ":[{x:300,y:1060,s:6},{x:300,y:860,s:7},{x:300,y:640,s:7}],"よ":[{x:240,y:1060,s:6},{x:240,y:860,s:7},{x:240,y:640,s:7}],"ら":[{x:180,y:1060,s:6},{x:180,y:860,s:7},{x:180,y:640,s:7}],"り":[{x:120,y:1060,s:6},{x:120,y:860,s:7},{x:120,y:640,s:7}],"る":[{x:60,y:1060,s:6},{x:60,y:860,s:7},{x:60,y:640,s:7}]}},w2:{wall:[{x:1e3,y:380},{x:1020,y:380},{x:1040,y:380},{x:1060,y:380},{x:1080,y:380},{x:1220,y:380},{x:1240,y:380},{x:1260,y:380},{x:1280,y:380},{x:1320,y:340},{x:1320,y:300},{x:1320,y:280},{x:1320,y:260},{x:1320,y:220},{x:1320,y:200},{x:1320,y:140},{x:1320,y:120},{x:1320,y:80},{x:1320,y:60},{x:1320,y:40},{x:1260,y:0},{x:1240,y:0},{x:1220,y:0},{x:1180,y:0},{x:1140,y:0},{x:1100,y:0},{x:1080,y:0},{x:1060,y:0},{x:840,y:0},{x:820,y:0},{x:800,y:0},{x:600,y:0},{x:580,y:0},{x:560,y:0},{x:360,y:0},{x:340,y:0},{x:320,y:0},{x:240,y:0},{x:180,y:0},{x:140,y:0},{x:120,y:0},{x:100,y:0},{x:0,y:40},{x:0,y:60},{x:0,y:80},{x:0,y:240},{x:0,y:260},{x:0,y:280},{x:0,y:460},{x:0,y:480},{x:0,y:500},{x:0,y:660},{x:0,y:680},{x:0,y:700},{x:0,y:920},{x:0,y:940},{x:0,y:960},{x:0,y:1e3},{x:0,y:1040},{x:0,y:1080},{x:0,y:1100},{x:0,y:1120},{x:60,y:1220},{x:100,y:1220},{x:120,y:1220},{x:140,y:1220},{x:180,y:1220},{x:200,y:1220},{x:240,y:1220},{x:260,y:1220},{x:300,y:1220},{x:320,y:1220},{x:340,y:1220},{x:380,y:1220}],"mark-coord":[{x:1315,y:355,c:"A"},{x:1315,y:-15,c:"A"},{x:20,y:1200,c:"A"},{x:10,y:-15,c:"A"}],"mark-list":{B:[{x:1260,y:220,s:5},{x:1260,y:60,s:4},{x:1200,y:220,s:5},{x:1200,y:60,s:4},{x:1140,y:220,s:5},{x:1140,y:60,s:4}],C:[{x:1080,y:220,s:5},{x:1080,y:60,s:4},{x:1020,y:220,s:5},{x:1020,y:60,s:4},{x:960,y:220,s:4},{x:960,y:80,s:3}],D:[{x:900,y:220,s:4},{x:900,y:80,s:3},{x:840,y:220,s:4},{x:840,y:80,s:3},{x:780,y:220,s:5},{x:780,y:60,s:4},{x:720,y:220,s:5},{x:720,y:60,s:4}],E:[{x:660,y:220,s:5},{x:660,y:60,s:4},{x:600,y:220,s:5},{x:600,y:60,s:4}],F:[{x:540,y:220,s:4},{x:540,y:80,s:3},{x:480,y:220,s:4},{x:480,y:80,s:3},{x:420,y:220,s:4},{x:420,y:80,s:3}],G:[{x:360,y:440,s:6},{x:360,y:220,s:6},{x:360,y:60,s:4}],H:[{x:300,y:420,s:7},{x:300,y:220,s:7},{x:300,y:60,s:4}],I:[{x:240,y:420,s:7},{x:240,y:220,s:7},{x:240,y:60,s:4}],J:[{x:180,y:420,s:7},{x:180,y:220,s:7},{x:180,y:60,s:4}],K:[{x:120,y:420,s:7},{x:120,y:220,s:7},{x:120,y:60,s:4}],L:[{x:60,y:420,s:7},{x:60,y:220,s:7},{x:60,y:60,s:4}],M:[{x:360,y:1060,s:5},{x:360,y:860,s:7},{x:360,y:640,s:7}],N:[{x:300,y:1060,s:6},{x:300,y:860,s:7},{x:300,y:640,s:7}],O:[{x:240,y:1060,s:6},{x:240,y:860,s:7},{x:240,y:640,s:7}],P:[{x:180,y:1060,s:6},{x:180,y:860,s:7},{x:180,y:640,s:7}],Q:[{x:120,y:1060,s:6},{x:120,y:860,s:7},{x:120,y:640,s:7}],R:[{x:60,y:1060,s:6},{x:60,y:860,s:7},{x:60,y:640,s:7}]}},k:{coord:[{x:210,y:120,w:20,h:20,n:1911},{x:230,y:120,w:20,h:20,n:1912},{x:250,y:120,w:20,h:20,n:1913},{x:270,y:120,w:20,h:20,n:1914},{x:130,y:180,w:20,h:40,n:1111},{x:250,y:180,w:20,h:20,n:1121},{x:250,y:200,w:20,h:20,n:1122},{x:250,y:220,w:20,h:40,n:1123},{x:270,y:220,w:20,h:40,n:1124},{x:270,y:180,w:20,h:40,n:1125},{x:390,y:180,w:20,h:60,n:1131},{x:410,y:180,w:20,h:60,n:1133},{x:390,y:240,w:40,h:20,n:1132},{x:530,y:180,w:20,h:40,n:1141},{x:550,y:180,w:20,h:40,n:1145},{x:550,y:220,w:20,h:40,n:1144},{x:530,y:220,w:20,h:20,n:1142},{x:530,y:240,w:20,h:20,n:1143},{x:670,y:180,w:20,h:60,n:1151},{x:690,y:180,w:20,h:60,n:1152},{x:110,y:360,w:20,h:40,n:1211},{x:130,y:360,w:20,h:40,n:1215},{x:110,y:400,w:20,h:40,n:1212},{x:130,y:400,w:20,h:20,n:1214},{x:130,y:420,w:20,h:20,n:1213},{x:250,y:360,w:20,h:20,n:1221},{x:250,y:380,w:20,h:20,n:1222},{x:250,y:400,w:20,h:20,n:1223},{x:250,y:420,w:20,h:20,n:1224},{x:270,y:420,w:20,h:20,n:1225},{x:270,y:400,w:20,h:20,n:1226},{x:270,y:360,w:20,h:40,n:1227},{x:390,y:360,w:20,h:40,n:1231},{x:410,y:360,w:20,h:40,n:1235},{x:410,y:400,w:20,h:40,n:1234},{x:390,y:400,w:20,h:20,n:1232},{x:390,y:420,w:20,h:20,n:1233},{x:530,y:360,w:20,h:20,n:1241},{x:530,y:380,w:20,h:60,n:1242},{x:550,y:360,w:20,h:40,n:1244},{x:550,y:400,w:20,h:40,n:1243},{x:670,y:360,w:20,h:40,n:1251},{x:670,y:400,w:20,h:20,n:1252},{x:670,y:420,w:20,h:20,n:1253},{x:690,y:360,w:20,h:80,n:1254},{x:110,y:600,w:20,h:40,n:1311},{x:110,y:640,w:20,h:40,n:1312},{x:130,y:640,w:20,h:40,n:1313},{x:130,y:600,w:20,h:40,n:1314},{x:250,y:600,w:20,h:20,n:1321},{x:250,y:620,w:20,h:20,n:1322},{x:250,y:640,w:20,h:40,n:1323},{x:270,y:640,w:20,h:40,n:1324},{x:270,y:600,w:20,h:40,n:1325},{x:390,y:600,w:20,h:20,n:1331},{x:390,y:620,w:20,h:20,n:1332},{x:390,y:640,w:20,h:20,n:1333},{x:390,y:660,w:20,h:20,n:1334},{x:410,y:640,w:20,h:40,n:1335},{x:410,y:620,w:20,h:20,n:1336},{x:410,y:600,w:20,h:20,n:1337},{x:530,y:600,w:20,h:20,n:1341},{x:530,y:620,w:20,h:20,n:1342},{x:530,y:640,w:20,h:40,n:1343},{x:550,y:660,w:20,h:20,n:1344},{x:550,y:620,w:20,h:40,n:1345},{x:550,y:600,w:20,h:20,n:1346},{x:670,y:600,w:20,h:40,n:1351},{x:670,y:640,w:20,h:40,n:1352},{x:690,y:600,w:20,h:80,n:1353},{x:30,y:760,w:20,h:60,n:1411},{x:230,y:840,w:20,h:20,n:1421},{x:250,y:840,w:80,h:20,n:1422},{x:450,y:860,w:60,h:20,n:1431},{x:510,y:860,w:40,h:20,n:1432},{x:670,y:860,w:40,h:20,n:1451},{x:710,y:860,w:60,h:20,n:1451},{x:1470,y:80,w:20,h:20,n:2911},{x:1490,y:80,w:20,h:20,n:2912},{x:1510,y:80,w:20,h:20,n:2913},{x:1530,y:80,w:20,h:20,n:2914},{x:1550,y:80,w:20,h:20,n:2915},{x:1570,y:80,w:20,h:20,n:2921},{x:1590,y:80,w:20,h:20,n:2922},{x:1610,y:80,w:20,h:20,n:2923},{x:1630,y:80,w:20,h:20,n:2924},{x:1650,y:80,w:20,h:20,n:2925},{x:1090,y:180,w:20,h:20,n:2111},{x:1090,y:200,w:20,h:20,n:2112},{x:1090,y:220,w:20,h:20,n:2113},{x:1110,y:200,w:20,h:40,n:2114},{x:1110,y:180,w:20,h:20,n:2115},{x:1230,y:180,w:20,h:40,n:2121},{x:1230,y:220,w:20,h:40,n:2122},{x:1250,y:240,w:20,h:20,n:2123},{x:1250,y:180,w:20,h:60,n:2124},{x:1370,y:180,w:20,h:80,n:2131},{x:1390,y:180,w:20,h:80,n:2132},{x:1090,y:360,w:20,h:80,n:2211},{x:1110,y:420,w:20,h:20,n:2212},{x:1110,y:400,w:20,h:20,n:2213},{x:1110,y:380,w:20,h:20,n:2214},{x:1110,y:360,w:20,h:20,n:2215},{x:1230,y:360,w:20,h:20,n:2221},{x:1230,y:380,w:20,h:20,n:2222},{x:1230,y:400,w:20,h:40,n:2223},{x:1250,y:400,w:20,h:40,n:2224},{x:1250,y:380,w:20,h:20,n:2225},{x:1250,y:360,w:20,h:20,n:2226},{x:1370,y:360,w:20,h:60,n:2231},{x:1370,y:420,w:20,h:20,n:2232},{x:1390,y:360,w:20,h:80,n:2233},{x:1510,y:360,w:20,h:40,n:2241},{x:1510,y:400,w:20,h:20,n:2242},{x:1510,y:420,w:20,h:20,n:2243},{x:1530,y:420,w:20,h:20,n:2244},{x:1530,y:400,w:20,h:20,n:2245},{x:1530,y:360,w:20,h:40,n:2246},{x:1630,y:360,w:20,h:20,n:2251},{x:1630,y:380,w:20,h:20,n:2252},{x:1630,y:400,w:20,h:40,n:2253},{x:1650,y:400,w:20,h:40,n:2254},{x:1650,y:360,w:20,h:40,n:2255},{x:1090,y:600,w:40,h:80,n:2311},{x:1230,y:600,w:20,h:20,n:2321},{x:1230,y:620,w:20,h:40,n:2322},{x:1230,y:660,w:20,h:20,n:2323},{x:1250,y:640,w:20,h:40,n:2324},{x:1250,y:600,w:20,h:40,n:2325},{x:1370,y:600,w:40,h:20,n:2331},{x:1370,y:620,w:20,h:20,n:2332},{x:1370,y:640,w:20,h:40,n:2333},{x:1390,y:620,w:20,h:60,n:2334},{x:1510,y:600,w:20,h:20,n:2341},{x:1510,y:620,w:20,h:20,n:2342},{x:1510,y:640,w:20,h:20,n:2343},{x:1510,y:660,w:20,h:20,n:2344},{x:1530,y:640,w:20,h:40,n:2345},{x:1530,y:600,w:20,h:40,n:2346},{x:1630,y:600,w:20,h:80,n:2351},{x:1650,y:600,w:20,h:80,n:2352},{x:1330,y:820,w:40,h:80,n:2431},{x:1490,y:860,w:20,h:20,n:2441},{x:1510,y:860,w:60,h:20,n:2442}]}};
mapSize = {s1: {width: 1240, height: 680}, s2: {width: 1240, height: 680}, w1: {width: 1800, height: 1280}, w2: {width: 1340, height: 1280}, k: {width: 1720, height: 1050}}

// サークルデータの読み込み
var circle_temp = JSON.parse(localStorage.getItem('circles'))
var circles_data = []

if(circle_temp === null || circle_temp === undefined) {
    console.log('データがないよ')
} else {
    for(var i = 0; Object.keys(circle_temp).length > i; i++) {
        circles_data.push(circle_temp[Object.keys(circle_temp)[i]])
    }
}

// pixelRatio_mapの設定 =>上げれば上げるほど解像度は上がるが重くなる
pixelRatio_map = 2

circle_box = {}

mapAssets_key = Object.keys(mapAssets)

// マップ描画
if($('#map-hall-w1').length !== 0) {
    for(i = 0; mapAssets_key.length > i; i++) {
        switch(mapAssets_key[i]) {
            case 'w1':
                draw_map_w(mapAssets.w1, 'w1')
                break
            case 'w2':
                draw_map_w(mapAssets.w2, 'w2')
                break
            case 's1':
                draw_map_s(mapAssets.s1, 's1')
                break
            case 's2':
                draw_map_s(mapAssets.s2, 's2')
                break
            case 'k':
                draw_map_k(mapAssets.k, 'k')
        }
    }
}

function draw_map_w(map_data, jquery) {
    // 初期化
    var map = $('#map-hall-' + jquery)[0]
    ctx = map.getContext('2d')
    ctx.font = '12px Noto Sans JP'
    map.width = map.width * pixelRatio_map
    map.height = map.height * pixelRatio_map
    map.style.width = (map.width / pixelRatio_map) + 'px'
    map.style.height = (map.height / pixelRatio_map) + 'px'
    ctx.scale(pixelRatio_map, pixelRatio_map)
    ctx.fillStyle = '#FFFFFF'
    ctx.fillRect(0, 0, (map.width / pixelRatio_map), (map.height / pixelRatio_map))
    ctx.fillStyle = '#000000'

    if(jquery === 'w1') {
        var item = map_data['wall-1']
        cl_num = 1
        for(var i = 0; item.length > i; i++) {
            var coord = item[i]
            nums = returnNum(cl_num++)
            ctx.strokeRect(coord.x, coord.y, 20, 20)
            ctx.font = '12px Noto Sans JP'
            ctx.fillText(nums, coord.x + 3, coord.y + 15)
            createTooltip(jquery, coord.y, coord.x, 'れ', nums)
        }
    
        var item = map_data['wall-2']
        cl_num = 1
        for(var i = 0; item.length > i; i++) {
            var coord = item[i]
            nums = returnNum(cl_num++)
            ctx.strokeRect(coord.x, coord.y, 20, 20)
            ctx.font = '12px Noto Sans JP'
            ctx.fillText(nums, coord.x + 3, coord.y + 15)
            createTooltip(jquery, coord.y, coord.x, 'あ', nums)
        }
        // 壁サークル番号
        var item = map_data['mark-coord']
        for(var i = 0; item.length > i; i++) {
            ctx.font = '20px Noto Sans JP'
            ctx.fillText(item[i].c, item[i].x, item[i].y + 30)
        }
        // 四角
        ctx.strokeRect(500, 450, 800, 750)
    } else {
        var item = map_data['wall']
        cl_num = 1
        for(var i = 0; item.length > i; i++) {
            var coord = item[i]
            nums = returnNum(cl_num++)
            ctx.strokeRect(coord.x, coord.y, 20, 20)
            ctx.font = '12px Noto Sans JP'
            ctx.fillText(nums, coord.x + 3, coord.y + 15)
            createTooltip(jquery, coord.y, coord.x, 'A', nums)
        }
        // 壁サークル番号
        var item = map_data['mark-coord']
        for(var i = 0; item.length > i; i++) {
            ctx.font = '20px Noto Sans JP'
            ctx.fillText(item[i].c, item[i].x, item[i].y + 30)
        }
        // 四角
        ctx.strokeRect(500, 400, 800, 800)
    }
    
    var obj_keys = Object.keys(map_data['mark-list'])
    var obj = map_data['mark-list']
    
    for(var i = 0; obj_keys.length > i; i++) {
        var island = obj[obj_keys[i]]
        var circle_num = calcCircle(island)
        // 3つに分離している島を処理する
        cl_num = 1
        cl_num2 = 0
        for(var j = 0; island.length > j; j++) {
            // 分離しているうちの1つを処理
            var single_island = island[j]

            // 文字入れ
            if(obj_keys[i].match(/[せそたちつてとぬねのはひふへBCDEF]/) && j === 0) {
                ctx.font = '20px Noto Sans JP'
                ctx.fillText(obj_keys[i], single_island.x + 10, single_island.y - 30)
            } else {
                if(j === 1 && !obj_keys[i].match(/[せそたちつてとぬねのはひふへBCDEF]/)) {
                    ctx.font = '20px Noto Sans JP'
                    ctx.fillText(obj_keys[i], single_island.x + 10, single_island.y - 30)
                }
            }
    
            ctx.font = '12px Noto Sans JP'

            // =========================================右側処理===========================================
            // サークル@下部

            nums = returnNum(cl_num++)
            
            ctx.strokeRect(single_island.x + 10, single_island.y + (20 * single_island.s), 20, 20)
            ctx.fillText(nums, single_island.x + 13, single_island.y + (20 * single_island.s) + 16)

            createTooltip(jquery, single_island.y + (20 * single_island.s), single_island.x + 10, obj_keys[i], nums)
    
            for(var k = 0; single_island.s > k; k++) {
                nums = returnNum(cl_num++)
                ctx.strokeRect(single_island.x + 20, single_island.y + (k * 20), 20, 20)
                ctx.fillText(nums, single_island.x + 23, single_island.y + ( single_island.s * 20 - (k * 20) ) - 6 )

                createTooltip(jquery, single_island.y + (k * 20), single_island.x + 20, obj_keys[i], nums)
            }
    
            // =========================================左側処理===========================================
            for(var k = 0; single_island.s > k; k++) {
                nums = circle_num - cl_num2++
                ctx.strokeRect(single_island.x, single_island.y + (k * 20), 20, 20)
                ctx.fillText(nums, single_island.x + 3, single_island.y + (single_island.s * 20 - (k * 20) ) - 6)

                createTooltip(jquery, single_island.y + (k * 20), single_island.x, obj_keys[i], nums)
            }
    
            // サークル@上部
            nums = circle_num - cl_num2++
            ctx.strokeRect(single_island.x + 10, single_island.y - 20, 20, 20)
            ctx.fillText(nums, single_island.x + 13, single_island.y - 5)

            createTooltip(jquery, single_island.y - 20, single_island.x + 10, obj_keys[i], nums)
        }
    }

}

function draw_map_s(map_data, jquery) {
    // 初期化
    var map = $('#map-hall-' + jquery)[0]
    ctx = map.getContext('2d')
    ctx.font = '12px Noto Sans JP'
    map.width = map.width * pixelRatio_map
    map.height = map.height * pixelRatio_map
    map.style.width = (map.width / pixelRatio_map) + 'px'
    map.style.height = (map.height / pixelRatio_map) + 'px'
    ctx.scale(pixelRatio_map, pixelRatio_map)
    ctx.fillStyle = '#FFFFFF'
    ctx.fillRect(0, 0, (map.width / pixelRatio_map), (map.height / pixelRatio_map))
    ctx.fillStyle = '#000000'

    // 壁サークル
    var item = map_data['wall']
    if(jquery === 's1') {
        var island_n = 'ア'
        cl_num = 0
        for(var i = 0; item.length > i; i++) {
            nums = returnNum(57 - cl_num++)
            var coord = item[i]
            ctx.strokeRect(coord.x, coord.y, 20, 20)
            ctx.font = '12px Noto Sans JP'
            ctx.fillText(nums, coord.x + 3, coord.y + 15)
            createTooltip(jquery, coord.y, coord.x, island_n, nums)
        }

        // 壁サークル番号
        var item = map_data['mark-coord']
        for(var i = 0; item.length > i; i++) {
            ctx.font = '20px Noto Sans JP'
            ctx.fillText(item[i].c, item[i].x, item[i].y + 40)
        }

    } else {
        var island_n = 'ナ'
        cl_num = 1
        for(var i = 0; item.length > i; i++) {
            nums = returnNum(cl_num++)
            var coord = item[i]
            ctx.strokeRect(coord.x, coord.y, 20, 20)
            ctx.font = '12px Noto Sans JP'
            ctx.fillText(nums, coord.x + 3, coord.y + 15)
            createTooltip(jquery, coord.y, coord.x, island_n, nums)
        }

        // 壁サークル番号
        var item = map_data['mark-coord']
        for(var i = 0; item.length > i; i++) {
            ctx.font = '20px Noto Sans JP'
            ctx.fillText(item[i].c, item[i].x, item[i].y + 40)
        }
    }

    // メイン処理
    for(var i = 0; map_data.x.length > i; i++) {
        var circle_num = 32 + (map_data.s[i] * 2)
        cl_num = 1
        cl_num2 = 0
        for(var j = 0; map_data.y.length > j; j++) {
            switch(j) {
                case 0:
                    var s = 9
                    break
                case 1:
                    var s = 7
                    break
                case 2:
                    var s = map_data.s[i]
            }

            if(j === 2) {
                var space = (7 - s) * 20
            } else {
                var space = 0
            }

            if(j === 0 || j === 1) {
                ctx.font = '20px Noto Sans JP'
                ctx.fillText(map_data.mark[i], map_data.x[i] + 10, map_data.y[j] - 12)
            }


            ctx.font = '12px Noto Sans JP'
            for(var k = 0; s > k; k++) {
                // ================右側処理================
                nums = returnNum(cl_num++)
                ctx.strokeRect(map_data.x[i] + 20, map_data.y[j] + (20 * k) + space, 20, 20)
                ctx.fillText(nums, map_data.x[i] + 23, map_data.y[j] + (s * 20 - (k * 20) ) - 6 + space)
                createTooltip(jquery, map_data.y[j] + (s * 20 - (k * 20) ) + space - 20, map_data.x[i] + 20, map_data.mark[i], nums)

                // ================左側処理================
                nums2 = circle_num - cl_num2++
                ctx.strokeRect(map_data.x[i], map_data.y[j] + (20 * k) + space, 20, 20)
                ctx.fillText(nums2, map_data.x[i] + 3, map_data.y[j] + (s * 20 - (k * 20) ) - 6 + space)
                createTooltip(jquery, map_data.y[j] + (s * 20 - (k * 20) ) + space - 20, map_data.x[i], map_data.mark[i], nums2)

            }
        }
    }
}

function draw_map_k(map_data, jquery) {
    // 初期化
    var map = $('#map-hall-' + jquery)[0]
    ctx = map.getContext('2d')
    ctx.font = '10px Noto Sans JP'
    map.width = map.width * pixelRatio_map
    map.height = map.height * pixelRatio_map
    map.style.width = (map.width / pixelRatio_map) + 'px'
    map.style.height = (map.height / pixelRatio_map) + 'px'
    ctx.scale(pixelRatio_map, pixelRatio_map)
    ctx.fillStyle = '#FFFFFF'
    ctx.fillRect(0, 0, (map.width / pixelRatio_map), (map.height / pixelRatio_map))
    ctx.fillStyle = '#000000'
    ctx.fillRect(900, 150, 3, 800) 

    for(var i = 0; map_data.coord.length > i; i++) {
        var item = map_data.coord[i]
        ctx.strokeRect(item.x, item.y, item.w, item.h)
        ctx.fillText((item.n + '').slice(0, 2), item.x + (item.w / 3), item.y + (item.h / 2))
        ctx.fillText((item.n + '').slice(2, 4), item.x + (item.w / 3), item.y + (item.h / 2) + 8)
    }
}

function createTooltip(hall, x, y, island, number) {
    if(circle_box[island] === undefined) {
        circle_box[island] = {}
    }
    if(circle_box[island][number] === undefined) {
        circle_box[island][number] = {}
    }
    circle_box[island][number] = {x: x, y: y, hall: hall}
    /*
    circles_data.find(data => {
        if(data.place.island === island && data.place.number === number) {
            $('#map-hall-' + hall + '-cover').append('<div class="tip-circle tooltiped" style="top: ' + x + 'px; left: ' + y + 'px;"></div>')
        }
    })
    */
}

function returnNum(num) {
    return ('0' + num).slice(-2)
}

function calcCircle(obj) {
    // サークル数計算
    var n = 0
    for(var i = 0; obj.length > i; i++) {
        n += obj[i].s * 2 + 2
    }
    return n
}

// 着色
function finalize() {
    var map_n = 0
    var map_array = {}
    var days_color = {"1": '#039be5', "2": '#d81b60', "3": '#ffb300', "4": '#43a047'}
    bug_send_coord = ''

    if(circle_box !== {}) {
        for(var i = 0; circles_data.length > i; i++) {
            var data = circles_data[i]
            if(map_array[data.place.island + data.place.number] === undefined) {
                map_array[data.place.island + data.place.number] = []
            }
            map_array[data.place.island + data.place.number].push(data)
        }
    
        for(var i = 0; Object.keys(map_array).length > i; i++) {
    
            var data = map_array[Object.keys(map_array)[i]][0]
            console.log(circle_box)
            var num = Object.keys(circle_box[data.place.island]).find(d => {
                return (d === data.place.number)
            })
            var coord = circle_box[data.place.island][num]
            bug_send_coord = {
                coord: JSON.stringify(coord),
                circle: circles_data.length
            }
            $('#map-hall-' + coord.hall + '-cover').append('<div class="tip-circle" id="map_temp-' + map_n + '" style="top: ' + coord.x + 'px; left: ' + coord.y + 'px;" onclick="openDetails(\'' + data.place.island + data.place.number + '\')"></div>')
            var ctx = $('#map-hall-' + coord.hall)[0].getContext('2d')
            ctx.fillStyle = days_color[data.place.date]
            ctx.fillRect(coord.y + 1, coord.x + 1, 18, 18)
            ctx.font = '12px Noto Sans JP'
            ctx.fillStyle = '#FFF'
            ctx.fillText(num, coord.y + 3, coord.x + 14)
    
            var array = map_array[data.place.island + data.place.number]
            var circle_list = []
            for(var j = 0; array.length > j; j++) {
                circle_list.push(array[j].name + ' (' + array[j].place.date + '日目/' + array[j].place.ab + ')')
            }
    
            var text = circle_list.join('<br>')
            tippy('#map_temp-' + map_n, {
                content: text
            })
    
            map_n++
        }
    }
}

finalize()

function openDetails(place) {
    $('.modal').modal() // DEBUG
    $('#map_circle_info_place').text(place)
    $('#map_circle_info_list').html('')
    var ma_array = map_array[place]
    for(var i = 0; ma_array.length > i; i++) {
        var dat = ma_array[i]
        $('#map_circle_info_list').append('<h6>・' + dat.name + '</h6><span style="color: ' + days_color[dat.place.date] + '">' + dat.place.date + '日目 - ' + dat.place.ab + '</span><br><span>' + dat.memo + '</span>')
    }
    var instance = M.Modal.getInstance($('#map_circle_info'))
    instance.open()
}
